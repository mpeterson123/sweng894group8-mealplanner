<?php
///////////////////////////////////////////////////////////////////////////////
// MealPlanner                             Penn State - Cohorts 19 & 20 @ 2018
///////////////////////////////////////////////////////////////////////////////
// [en]Crypt[ion] Module
///////////////////////////////////////////////////////////////////////////////
// encrypt()
// decrypt()
// encodeBase64()
// decodeBase64()
///////////////////////////////////////////////////////////////////////////////

// Constants
define( '__CRYPT_KEY__' , 'Capstone' );     // DO NOT CHANGE! (unless certain!)

///////////////////////////////////////////////////////////////////////////////
// encrypt()
///////////////////////////////////////////////////////////////////////////////
// Encrypts a string into base64 string based on a Key
///////////////////////////////////////////////////////////////////////////////
// Returns: String
///////////////////////////////////////////////////////////////////////////////
function encrypt($stringData, $Key=__CRYPT_KEY__)
{
    $result = '';

    for($i = 0; $i < strlen($stringData); $i++)
    {
        $character = substr($stringData, $i, 1);
        $keyChar   = substr($Key, ($i % strlen($Key)) - 1, 1);
        $character = chr(ord($character) + ord($keyChar));
        $result   .= $character;
    }

    return encodeBase64($result);
}

///////////////////////////////////////////////////////////////////////////////
// decrypt()
///////////////////////////////////////////////////////////////////////////////
// Decrypts a base64 key-based encryption
///////////////////////////////////////////////////////////////////////////////
// Returns: String
///////////////////////////////////////////////////////////////////////////////
function decrypt($stringData, $Key=__CRYPT_KEY__)
{
    $result     = '';
    $stringData = decodeBase64($stringData);

    for($i = 0; $i < strlen($stringData); $i++)
    {
        $character = substr($stringData, $i, 1);
        $keyChar   = substr($Key, ($i % strlen($Key)) - 1, 1);
        $character = chr(ord($character) - ord($keyChar));
        $result   .= $character;
    }

    return $result;
}

///////////////////////////////////////////////////////////////////////////////
// encodeBase64()
///////////////////////////////////////////////////////////////////////////////
// Encodes a string into a particular base64 type
///////////////////////////////////////////////////////////////////////////////
// Returns: String
///////////////////////////////////////////////////////////////////////////////
function encodeBase64($stringData)
{
    $base64String = base64_encode($stringData);

    return strtr($base64String, '+/', '-_');
}

///////////////////////////////////////////////////////////////////////////////
// decodeBase64()
///////////////////////////////////////////////////////////////////////////////
// Encodes a string from a particular base64 type
///////////////////////////////////////////////////////////////////////////////
// Returns: String
///////////////////////////////////////////////////////////////////////////////
function decodeBase64($stringData)
{
    $base64String = strtr($stringData, '-_', '+/');

    return base64_decode($base64String);
}


?>
